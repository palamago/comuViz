<!DOCTYPE html>
<html>
<head>
	<script type="text/javascript" src="https://www.google.com/jsapi"></script>
	<script type="text/javascript">
	var ge;

	google.load("earth", "1");

	function initCB(instance) {
	   	ge = instance;
	   	
	   	ge.getWindow().setVisibility(true);
	   	ge.getNavigationControl().setVisibility(ge.VISIBILITY_AUTO);

	   	google.earth.fetchKml(ge, 'https://raw.github.com/palamago/comuViz/master/comunas-poblacion.kml', function(kmlObject) {
		    if(kmlObject) {
				ge.getFeatures().appendChild(kmlObject);
			}
		});

		ge.getOptions().setFlyToSpeed(0.4);

		var lookAt = ge.getView().copyAsLookAt(ge.ALTITUDE_RELATIVE_TO_GROUND);
		
		lookAt.setLatitude(-34.62);
		lookAt.setLongitude(-58.44);
		lookAt.setRange(lookAt.getRange() / 800.0);
		lookAt.setTilt(50);
		ge.getView().setAbstractView(lookAt);
	}

	function failureCB(errorCode) { }

	function init() {
	  	google.earth.createInstance('map', initCB, failureCB);		
	}

	google.setOnLoadCallback(init);

	</script>
</head>
<body>
	<div id="map" style="height: 400px; width: 600px;"></div>
</body>
</html>